name: CI Pipeline for Spring Boot

on:
  push:
    branches:
      - feat/cicd  # feat/cicd ë¸Œëœì¹˜ì— pushë  ë•Œ ì‹¤í–‰
  pull_request:
    branches:
      - feat/cicd  # feat/cicd ë¸Œëœì¹˜ì— PRì´ ìƒì„±ë  ë•Œ ì‹¤í–‰

jobs:
  build:
    name: Build & Test
    runs-on: ubuntu-22.04  # Ubuntu 22.04 í™˜ê²½ ì„¤ì •

    steps:
      # ğŸŸ¢ 1. ì €ì¥ì†Œ ì½”ë“œ ë‹¤ìš´ë¡œë“œ
      - name: Checkout Repository
        uses: actions/checkout@v3

      # ğŸŸ¢ 2. Java 17 í™˜ê²½ ì„¤ì •
      - name: Set up JDK 17
        uses: actions/setup-java@v3
        with:
          distribution: 'temurin'
          java-version: '17'

      # ğŸŸ¢ 3. Gradle ë¹Œë“œ (Maven ì‚¬ìš© ì‹œ ë³€ê²½ ê°€ëŠ¥)
      - name: Grant execute permission for Gradle
        run: chmod +x gradlew

      - name: Build Project
        run: ./gradlew clean build -x test  # í…ŒìŠ¤íŠ¸ ì œì™¸í•˜ê³  ë¹Œë“œ (í…ŒìŠ¤íŠ¸ëŠ” ë‹¤ìŒ ë‹¨ê³„ì—ì„œ ìˆ˜í–‰)

      # ğŸŸ¢ 4. í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (JUnit, Spock ë“±)
      - name: Run Tests
        run: ./gradlew test

      # ğŸŸ¢ 5. ë¹Œë“œ ê²°ê³¼ ì €ì¥ (ì„ íƒì‚¬í•­)
      - name: Save Build Artifact
        uses: actions/upload-artifact@v3
        with:
          name: springboot-app
          path: build/libs/*.jar  # ë¹Œë“œëœ JAR íŒŒì¼ ì €ì¥
